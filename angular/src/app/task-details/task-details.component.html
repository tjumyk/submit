<app-error-message [error]="error"></app-error-message>

<div *ngIf="task">
  <div class="ui segment task-description" *ngIf="task.description">
    {{ task.description }}
  </div>

  <div class="ui segments" *ngIf="materialCategories.length">
    <div class="ui segment" *ngFor="let category of materialCategories">
      <h4 class="ui header">
        <i class="icon" [ngClass]="category.icon"></i>
        <div class="content">
          {{ category.type | titlecase }}
        </div>
      </h4>
      <ul class="ui list enhanced">
        <li class="item" *ngFor="let mat of category.items">
          <div class="content">
            <div class="header"><a href="api/materials/{{mat.id}}/download">{{mat.name}}</a></div>
            <div class="metadata">
              <span>Size: {{mat.size|size}}</span>
              <span>MD5:
                <span [attr.data-tooltip]="mat.md5" data-position="bottom center">
                  {{mat.md5|slice:0:6}}
                </span>
              </span>
              <span>Last Updated: {{mat.modified_at | date: 'short'}}</span>
            </div>
            <div class="description">{{mat.description}}</div>
          </div>
        </li>
      </ul>
    </div>
    <div class="ui segment center aligned">
      <a href="api/tasks/{{taskId}}/download-materials-zip" class="ui button primary">
        <i class="icon file archive outline"></i>
        Download All as Zip
      </a>
    </div>
  </div>

  <div class="ui segment" *ngIf="task.file_requirements.length">
    <h4 class="ui header">
      <i class="icon paper plane outline"></i>
      <div class="content">Submission Requirements</div>
    </h4>
    <ul class="ui list enhanced">
      <li class="item" *ngFor="let req of task.file_requirements">
        <div class="content">
          <div class="header">{{req.name}}</div>
          <div class="metadata">
            <span *ngIf="req.is_optional">(Optional)</span>
            <span *ngIf="req.size_limit!=null; else noSizeLimit">Up to {{req.size_limit | size}}</span>
            <ng-template #noSizeLimit>Unlimited size</ng-template>
          </div>
          <div class="description">{{req.description}}</div>
        </div>
      </li>
    </ul>
  </div>
</div>
